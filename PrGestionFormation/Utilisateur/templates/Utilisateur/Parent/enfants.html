{% extends 'Accuiel/Parent/base.html' %} {% load static %} 
{% load widget_tweaks%} {% block contentetudiant %}
<div class="card shadow-lg border-0 rounded-3 overflow-hidden mb-4">
  <!-- En-tête du enfants_parent -->
  <div class="bg-gradient-primary text-white p-4">
    <div class="d-flex align-items-center">
      <div class="bg-white bg-opacity-20 rounded-circle p-3 me-3">
        <i class="bx bx-group text-primary fs-3"></i>
      </div>
      <div>
        <h3 class="mb-1 fw-bold">Enfants</h3>
        <p class="mb-0 opacity-75">Informations sur vos enfants</p>
      </div>
    </div>
  </div>
  <div class="card-body">
    {% if user.role == "PARENT" %} {% if user.parent.enfants.all %}
    <div class="row g-3">
      {% for etudiant in user.parent.enfants.all %}
        <div class="col-12 col-md-6">
          <a
        href="{% url 'utilisateur:enfant_detail' pk=etudiant.utilisateur.pk %}"
        class="text-decoration-none small text-white-50"
      >
          {% if etudiant.utilisateur.pk == pk %}
          <div class="card border-0 bg-primary bg-opacity-10 h-100">
            <div class="card-body p-3">
              <div class="d-flex align-items-center">
                <div class="position-relative me-3">
                  {% if etudiant.utilisateur.photo %}
                  <img
                    src="{{ etudiant.utilisateur.photo.url }}"
                    alt="Photo de {{ etudiant.utilisateur.first_name }}"
                    class="rounded-circle"
                    style="width: 50px; height: 50px; object-fit: cover"
                  />
                  {% else %}
                  <img
                    src="{% static 'assets/img/avatars/1.png' %}"
                    alt="Avatar par défaut"
                    class="rounded-circle"
                    style="width: 50px; height: 50px; object-fit: cover"
                  />
                  {% endif %}
                </div>
                <div class="flex-grow-1">
                  <h6 class="mb-1 fw-bold text-white">
                    {{ etudiant.utilisateur.last_name }} 
                    {{ etudiant.utilisateur.first_name }}
                  </h6>
                  <small class="text-muted d-block text-white-50"
                    >{{ etudiant.utilisateur.matricule }}</small
                  >
                  <small class="text-decoration-none small text-white-50">
                    {{ etudiant.utilisateur.email }}
                  </small>
                </div>
                <div class="text-end">
                  <span class="badge bg-warning text-dark">
                    {% if etudiant.classe_actuelle %} 
                    {{ etudiant.classe_actuelle.nom }} 
                    {% else %} 
                    Non défini
                    {% endif %}
                  </span>
                </div>
              </div>
            </div>
          </div>
          {% else %}
          <div class="card border-0 bg-light h-100">
            <div class="card-body p-3">
              <div class="d-flex align-items-center">
                <div class="position-relative me-3">
                  {% if etudiant.utilisateur.photo %}
                  <img
                    src="{{ etudiant.utilisateur.photo.url }}"
                    alt="Photo de {{ etudiant.utilisateur.first_name }}"
                    class="rounded-circle"
                    style="width: 50px; height: 50px; object-fit: cover"
                  />
                  {% else %}
                  <img
                    src="{% static 'assets/img/avatars/1.png' %}"
                    alt="Avatar par défaut"
                    class="rounded-circle"
                    style="width: 50px; height: 50px; object-fit: cover"
                  />
                  {% endif %}
                </div>
                <div class="flex-grow-1">
                  <h6 class="mb-1 fw-bold">
                    {{ etudiant.utilisateur.last_name }} 
                    {{ etudiant.utilisateur.first_name }}
                  </h6>
                  <small class="text-muted d-block"
                    >{{ etudiant.utilisateur.matricule }}</small
                  >
                  <small class="text-decoration-none small">
                    {{ etudiant.utilisateur.email }}
                  </small>
                </div>
                <div class="text-end">
                  <span class="badge bg-warning text-dark">
                    {% if etudiant.classe_actuelle %} 
                    {{ etudiant.classe_actuelle.nom }} 
                    {% else %} 
                    Non défini
                    {% endif %}
                  </span>
                </div>
              </div>
            </div>
          </div>
          {% endif %}
          </a>
        </div>
      {% endfor %}
    </div>
    {% else %}
    <div class="text-center py-4">
      <i class="bx bx-user-x text-muted fs-1"></i>
      <p class="text-muted mb-0">Aucun enfant enregistré</p>
    </div>
    {% endif %} 
    {% endif %}
  </div>
</div>

{% if enfant %}
<div class="card shadow-lg border-0 rounded-3 overflow-hidden mb-4">
  <!-- En-tête d'enfant -->
  <div class="bg-gradient-primary text-white p-4">
    <div class="card-body p-3">
      <div class="d-flex align-items-center">
        <div class="position-relative me-3">
          {% if enfant.utilisateur.photo %}
          <img
            src="{{ enfant.utilisateur.photo.url }}"
            alt="Photo de {{ enfant.utilisateur.first_name }}"
            class="rounded-circle"
            style="width: 50px; height: 50px; object-fit: cover"
          />
          {% else %}
          <img
            src="{% static 'assets/img/avatars/1.png' %}"
            alt="Avatar par défaut"
            class="rounded-circle"
            style="width: 50px; height: 50px; object-fit: cover"
          />
          {% endif %}
        </div>
        <div class="flex-grow-1">
          <h6 class="mb-1 fw-bold text-white">
            {{ enfant.utilisateur.last_name }} {{ enfant.utilisateur.first_name}} 
          </h6>
          <small class="text-muted d-block"
            >{{ enfant.utilisateur.matricule }}</small
          >
          <small class="text-decoration-none small text-white-50">
            {{ enfant.utilisateur.email }}
          </small>
        </div>
        <div class="text-end">
          <span class="badge bg-warning text-dark">
            {% if enfant.classe_actuelle %} {{ enfant.classe_actuelle.nom }} 
            {% else %} Non défini {% endif %}
          </span>
        </div>
      </div>
    </div>
  </div>
  <div class="nav-align-top mb-4 bg-dark">
    {% include "./Nav/nav_enfants.html" %}
  </div>                                                                          
  <div class="card-body">
    {% if active_view == "VueEnsemble" %}
        {% include "Utilisateur/Etudiant/vuedensemble.html" %}
    {% elif active_view == "notes" %}
        {% include "Utilisateur/Etudiant/notes.html" %}
    {% elif active_view == "calendrier" %}
        {% include "Utilisateur/Etudiant/calendrier_etudiant.html" %}
    {% elif active_view == "documents" %}
        {% include "Utilisateur/Etudiant/documents.html" %}
    {% elif active_view == "communications" %}
        {% include "Utilisateur/Parent/communications.html" %}
    {% elif active_view == "assiduite" %}
        {% include "Utilisateur/Etudiant/assiduite.html" %}
    {% endif %}
  </div>
</div>
{% endif %} {% endblock %}
